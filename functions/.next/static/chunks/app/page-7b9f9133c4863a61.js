(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1115:(e,t,o)=>{"use strict";o.d(t,{AuthProvider:()=>i,c:()=>a});var n=o(5155),l=o(6104),r=o(6203),s=o(2115);let a=(0,s.createContext)({currentUser:null}),i=e=>{let{children:t}=e,[o,i]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(0,r.hg)(l.j2,e=>e&&i(e))},[]),(0,n.jsx)(a.Provider,{value:{currentUser:o},children:t})}},4615:(e,t,o)=>{"use strict";o.d(t,{default:()=>a});var n=o(5155),l=o(2115),r=o(6104),s=o(1115);let a=()=>{let{currentUser:e}=(0,l.useContext)(s.c);return console.log("currentUser",e),(0,n.jsxs)("header",{children:["ヘッダー",e?(0,n.jsx)("button",{onClick:r.je,children:"ログアウト"}):(0,n.jsx)("button",{onClick:r.E8,children:"ログイン"})]})}},6104:(e,t,o)=>{"use strict";o.d(t,{E8:()=>c,j2:()=>d,je:()=>u});var n=o(3915),l=o(5317),r=o(6203);let s={apiKey:"AIzaSyCrwviNLdjJ345oBhYwfP5QDAKJnlGqJOU",authDomain:"next-todo-pwa.firebaseapp.com",databaseURL:o(9509).env.NEXT_PUBLIC_APP_FIREBASE_DATABASE_URL,projectId:"next-todo-pwa",storageBucket:"next-todo-pwa.firebasestorage.app",messagingSenderId:"100111459857",appId:"1:100111459857:web:791bc92ab3c908fbfef3b0",measurementId:"100111459857"},a=(0,n.Wp)(s);(0,l.aU)(a);let i=new r.HF,d=(0,r.xI)(),c=()=>{(0,r.df)(d,i).then(e=>{console.log(e.user)}).catch(e=>{console.log(e)})},u=()=>{(0,r.CI)(d).then(()=>{document.location.reload()}).catch(()=>{console.log("サインアウトエラー")})}},6474:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});var n=o(5155),l=o(2115),r=o(1115),s=o(6104);let a=e=>{let{todos:t,getTodo:o}=e,l=async e=>{console.log("delete click"),await fetch("/api/deleteTodo",{method:"POST",body:JSON.stringify({id:e}),headers:{"Content-Type":"application/json"}}),o()};return(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"あなたのToDo"}),(0,n.jsx)("ul",{children:t.map(e=>(0,n.jsxs)("li",{children:[e.content,(0,n.jsx)("button",{onClick:()=>l(e.id),children:"削除"})]},e.id))})]})},i=()=>{let{currentUser:e}=(0,l.useContext)(r.c),t=(0,l.useRef)(null),[o,i]=(0,l.useState)(),d=(0,l.useCallback)(async()=>{if(e){let t=await fetch("/api/getTodo",{method:"POST",body:JSON.stringify({uid:e.uid}),headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch todos");i(await t.json())}},[e]);(0,l.useEffect)(()=>{d()},[e,d]);let c=async()=>{var o;(null==(o=t.current)?void 0:o.value)&&(null==e?void 0:e.uid)&&(await fetch("/api/addTodo",{method:"POST",body:JSON.stringify({content:t.current.value,uid:e.uid}),headers:{"Content-Type":"application/json"}}),t.current.value="",d())};return(0,n.jsxs)("div",{children:[e?(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{placeholder:"ToDoName",ref:t}),(0,n.jsx)("button",{onClick:c,type:"button",children:"追加"})]}):(0,n.jsx)("button",{onClick:s.E8,children:"ログイン"}),o&&e&&(0,n.jsx)(a,{todos:o,getTodo:d})]})}},8518:(e,t,o)=>{Promise.resolve().then(o.bind(o,6474)),Promise.resolve().then(o.bind(o,4615))}},e=>{var t=t=>e(e.s=t);e.O(0,[992,811,645,441,684,358],()=>t(8518)),_N_E=e.O()}]);